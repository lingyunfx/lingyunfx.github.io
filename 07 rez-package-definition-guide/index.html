<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		07 Package Definition Guide | 
	 
	凌云的个人博客
	</title>
	
	<!-- keywords,description -->
	 
		<meta name="description" content="关于视效的学习和分享" />
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "lingyunfx.com";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@v1.4.14/dist/Valine.min.js"></script>

	
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
	<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3efe99c287df5a1d6f0d02d187e403c1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<header id="header">
    <a id="title" href="/" class="logo">凌云的个人博客</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
	

	

		<li class="menu-item">
			<a href="https://gitlab.lingyunfx.com/zhangly" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li>
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="按回车全站搜索">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Article
									</a>
									
							<ul>
								<li class="file">
									<a href="/ASWF-intro/">
										简单了解一下ASWF
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/asset-library-share/">
										分享几个三维模型资产库应用
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/command-tool-intro/">
										命令行工具的三把瑞士军刀
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-flipping-camera/">
										在Maya中进行Flipping Camera
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-link-unreal/">
										UE4和Maya的数据通信
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-replace-ref-tool/">
										批量替换Maya Reference工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-retime-tool-intro/">
										Maya动画变速工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/meshlab-remove-face/">
										使用MeshLab为模型减面
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/metahuman-intro/">
										MetaHumans Creator初体验
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/notion-intro/">
										使用Notion建立个人Wiki
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/reject-maya-warning/">
										关于“你的文件贼健康”的简单处理方式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tracker_connect_camera/">
										Vive Tracker控制Camera
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tracks-2d-tools/">
										在不同跟踪软件之间的2D点转换工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/whats-matchmoving/">
										电影视效制作中的Matchmove
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										DCC
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Houdini
									</a>
									
							<ul>
								<li class="file">
									<a href="/houdini_codes/">
										代码参考
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/houdini_tips/">
										Houdini Tips
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/houdini_basic/">
										1.界面及视图操作技巧
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/houdini_network_basic/">
										2.NetWork界面操作及快捷键
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/houdini_node_basic/">
										3.常用节点及操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Maya
									</a>
									
							<ul>
								<li class="file">
									<a href="/learn-minq/">
										maya第三方库minq学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-issue-vol1/">
										Maya疑难杂症备忘录 Vol.1
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-py-to-pyd/">
										将Maya的python代码编译成pyd
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-tips-001/">
										Maya的效率使用和技巧（一）
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya-tips-002/">
										Maya的效率使用和技巧（二）
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya_cmds/">
										maya command代码段
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya_environment_variable/">
										Maya环境变量表
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/mtoa-install-issue/">
										安装Arnold后环境变量被破坏
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										绑定学习笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/maya_adv_workflow/">
										Maya Adv插件使用流程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/maya_rigging_basic/">
										Maya角色动画绑定基础入门
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Nuke
									</a>
									
							<ul>
								<li class="file">
									<a href="/nk_call_back/">
										Nuke的Call Back使用
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/nk_custom_knob/">
										Nuke自定义Knob操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/nk_gizmo_make/">
										Nuke Gizmo制作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/nk_node_animation/">
										Nuke节点动画操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/nk_tcl/">
										Nuke tcl脚本
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/ns_py_intro/">
										NukeStudio常用命令参考
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/nuke-trn-lens-distort/">
										使用LensDistortion节点输出STMap
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/nuke_py_intro/">
										Nuke 开发基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Unreal
									</a>
									
							<ul>
								<li class="file">
									<a href="/unreal-python-01/">
										UE开发的一点心得经验（一）
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/unreal_code_ref/">
										Unreal Python代码段
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/unreal_motion_redirect/">
										Unreal 动画重定向
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/unreal4_basic/">
										虚幻4基础操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/unreal4_fps/">
										用虚幻4蓝图制作FPS
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/unreal4_jc_learning/">
										谌嘉诚教程学习笔记
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Geek
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Cloudreve
									</a>
									
							<ul>
								<li class="file">
									<a href="/cloudreve-install/">
										搭建Cloudreve私有云盘
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Docker
									</a>
									
							<ul>
								<li class="file">
									<a href="/docker_command/">
										Docker 常用命令
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Gitlab
									</a>
									
							<ul>
								<li class="file">
									<a href="/git_command/">
										Git 常用命令
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/gitlab_install/">
										Gitlab在Centos上搭建
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/gitlab_win_install/">
										Gitlab在Windows10搭建
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Linux
									</a>
									
							<ul>
								<li class="file">
									<a href="/firewall_cmd/">
										防火墙相关
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/linux_command_cmd/">
										Linux 常用命令
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/shell_learn/">
										Shell脚本学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Nginx
									</a>
									
							<ul>
								<li class="file">
									<a href="/nginx_learn/">
										Nginx学习笔记
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										PostgreSql
									</a>
									
							<ul>
								<li class="file">
									<a href="/postgres_cmd/">
										PostgreSql 操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/postgres_install/">
										PostgreSql 安装和配置
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Vim
									</a>
									
							<ul>
								<li class="file">
									<a href="/vim-help/">
										vim快捷键查询
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Mac
									</a>
									
							<ul>
								<li class="file">
									<a href="/mac-issue/">
										Mac的一些问题备忘
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py2app-used/">
										将Python程序打包成App过程和排错
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Python
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										学习笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/miniconda/">
										Minconda使用
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py3_feature/">
										Python3的一些新特性
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py_class_extra/">
										面向对象进阶
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py_network/">
										网络通信
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py_process/">
										并发编程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py_re/">
										正则学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										查询
									</a>
									
							<ul>
								<li class="file">
									<a href="/py_common_cod/">
										代码段记录
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py_dict/">
										Python字典方法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py_list/">
										Python列表方法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/py_str/">
										Python字符串方法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/pyqt_widgets/">
										PyQt常用控件
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										TD Pipeline
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										CGWire
									</a>
									
							<ul>
								<li class="file">
									<a href="/cgwire-install/">
										搭建CGWire
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Rez
									</a>
									
							<ul>
								<li class="file">
									<a href="/00%20rez-wiki-cn/">
										00 Rez中文文档
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/01%20rez-home/">
										01 Home
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/02%20rez-install/">
										02 Installation
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/03%20rez-getting-started/">
										03 Getting Started
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/04%20rez-basic-concepts/">
										04 Basic Concepts
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/05%20rez-configuring/">
										05 Configuring Rez
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/06%20rez-package-commands/">
										06 Package Commands
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/07%20rez-package-definition-guide/">
										07 Package Definition Guide
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/08%20rez-variants/">
										08 Variants
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/09%20rez-ephemeral-packages/">
										09 Ephemeral Packages
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/10%20rez-contexts/">
										10 Contexts
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/11%20rez-bundles/">
										11 Bundles
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/12%20rez-suites/">
										12 Suites
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/13%20rez-building-package/">
										13 Building Packages
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/14%20rez-copying-package/">
										14 Copying Packages
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/15%20rez-package-caching/">
										15 Package Caching
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/16%20rez-environment-variables/">
										16 Environment Variables
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/rez-intro/">
										Rez介绍（使用篇）
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Shotgun
									</a>
									
							<ul>
								<li class="file">
									<a href="/sg_common_command/">
										Shotgun常用代码段
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/sg_entity/">
										Shotgun可控制的Entity
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/sg_official_example/">
										Shotgun一些官方例子
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">
	07 Package Definition Guide
</h1>
<div class="article-meta">
	
	<span>zhangly</span>
	<span>2021-03-15 17:34:10</span>
		<div id="article-categories">
    
		<span>Categories：</span>
            
                
                    <span>
                        <i class="fa fa-folder" aria-hidden="true">
                        <a href="/categories/TD-Pipeline/">TD Pipeline</a>
                        </i>
                      
                        >
                      
                    </span>
                
            
                
                    <span>
                        <i class="fa fa-folder" aria-hidden="true">
                        <a href="/categories/TD-Pipeline/Rez/">Rez</a>
                        </i>
                      
                    </span>
                
            
    

    
		<span>Tags：</span>
            
    
		</div>

</div>

<div id="article-content">
	<h1><span id="概述">概述</span></h1><p>软件包的定义来自文件（package.py），位于每个包安装的根目录下。<br>比如包的存储位置为<code>/packages/inhouse</code>，则包”foo-1.0.0”的定义文件路径是：<br><code>/packages/inhouse/foo/1.0.0/package.py</code></p>
<p>这里是一个定义文件的例子：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">name <span class="token operator">=</span> <span class="token string">'sequence'</span>

version <span class="token operator">=</span> <span class="token string">'2.1.2'</span>

description <span class="token operator">=</span> <span class="token string">'Sequence detection library.'</span>

authors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'ajohns'</span><span class="token punctuation">]</span>

tools <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'lsq'</span><span class="token punctuation">,</span>
    <span class="token string">'cpq'</span>
<span class="token punctuation">]</span>

requires <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'python-2.6+&lt;3'</span><span class="token punctuation">,</span>
    <span class="token string">'argparse'</span>
<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    env<span class="token punctuation">.</span>PATH<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"&#123;root&#125;/bin"</span><span class="token punctuation">)</span>
    env<span class="token punctuation">.</span>PYTHONPATH<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"&#123;root&#125;/python"</span><span class="token punctuation">)</span>

uuid <span class="token operator">=</span> <span class="token string">'6c43d533-92bb-4f8b-b812-7020bf54d3f1'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1><span id="软件包属性">软件包属性</span></h1><p>包定义文件中的每一个变量都会成为已构建或已安装的软件包的属性。<br>所以你可以在包中添加任何自定义属性，不过有些属性并作为包的属性添加，<br>比如下面这个：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys

description <span class="token operator">=</span> <span class="token string">"This package was built on %s"</span> <span class="token operator">%</span> sys<span class="token punctuation">.</span>platform<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>因为我们并不想让sys成为一个包属性，这会和python标准模块冲突。<br>所以不会成为包属性的包括：</p>
<ul>
<li>python 模块</li>
<li>函数，不包括预/后绑定函数，不包含命令和相关函数</li>
<li>任何前面有双下划线的变量</li>
<li>任何作为构建时软件属性的变量</li>
</ul>
<h1><span id="包属性作为函数">包属性作为函数</span></h1><p>包属性可以包装成函数，函数的返回值为属性值。</p>
<p>有两种类型的属性函数：<br><strong>预绑定函数</strong>(early binding function)和<strong>后绑定函数</strong>(late binding function)。<br>它们分别使用装饰器<code>@early</code>和<code>@late</code>来装饰。</p>
<p>包定义的commands函数是例外，它们是后期绑定，但与标准的函数属性不同，不能用上述的装饰器来装饰。</p>
<h2><span id="预绑定函数">预绑定函数</span></h2><p>预绑定函数使用<code>@early</code>装饰器，它们在构建时执行，任何包属性都可以作为预绑定函数来实现。<br>这是一个authors属性的示例，该函数返回包的git项目的贡献者：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">authors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> subprocess
    p <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"git shortlog -sn | cut -f2"</span><span class="token punctuation">,</span>
                         shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>
    out<span class="token punctuation">,</span> _ <span class="token operator">=</span> p<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> out<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>预绑定函数还可以访问其它软件包的属性：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># a not very useful description</span>
    <span class="token keyword">return</span> <span class="token string">"%s version %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>name<span class="token punctuation">,</span> this<span class="token punctuation">.</span>version<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>注意</strong>：不要在预绑定函数中使用其它预绑定函数或后绑定函数的属性，否则会报错。</p>
<p>预绑定函数很方便的一点是，你可以使用任意的函数来替代，像这样：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">"%s version %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>name<span class="token punctuation">,</span> this<span class="token punctuation">.</span>version<span class="token punctuation">)</span>

description <span class="token operator">=</span> _description<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>可用对象：</strong></p>
<ul>
<li>building：返回值为布尔，如果正在构建返回True</li>
<li>build_variant_index：当前正在构建variant的索引值，只有当building为True才有效。</li>
<li>build_variant_requires：当前构建的软件包的子集，是PackageRequest对象的列表，只有当building为True才有效。</li>
<li>this：当前包。</li>
</ul>
<p><strong>注意：</strong>预绑定函数实际上会在构建过程中执行多次，在构建期间进行一次，然后对每个变体进行一次。这是为了让预绑定函数可以根据比如build_variant_index等variant来更改它们的返回值。</p>
<p>比如你希望requires字段仅在运行时返回某个软件包（软件包构建的时候不需要返回那个软件包）。<br>可以这样写：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">requires</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> building<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"python-2"</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"runtimeonly-1.2"</span><span class="token punctuation">,</span> <span class="token string">"python-2"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2><span id="后绑定函数">后绑定函数</span></h2><p>后绑定函数作为函数保留在已安装的软件包定义中，<br>并且在第一次调用的时候才进行求值（然后会将返回值进行缓存）。<br>允许的属性有：</p>
<ul>
<li>requires</li>
<li>build_requires</li>
<li>private_build_requires</li>
<li>tools</li>
<li>help</li>
<li>any arbitrary attribute</li>
</ul>
<p>下面是一个后绑定函数的示例：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@late</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">tools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> os

    <span class="token comment"># get everything in bin dir</span>
    binpath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>this<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token string">"bin"</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>binpath<span class="token punctuation">)</span>

    <span class="token comment"># we don't want artists to see the admin tools</span>
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"_USER_ROLE"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"superuser"</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"delete-all"</span><span class="token punctuation">,</span> <span class="token string">"mod-things"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>注意</strong>：后绑定函数使用到的模块必须在函数内进行导入，而不是package.py文件顶部。<br>还有一点是，比如函数只是为了返回bin目录的一个路径，最好是将它写作为一个预绑定函数，<br>这样对性能来说更节省。</p>
<p>但如果有一个环境变量”_USER_ROLE”是在构建时未知的，则适用于写作后绑定函数。<br>有时候我们会通过预绑定函数来存储一个属性来减少运行时的成本，再到后绑定函数中直接读取这个属性，<br>比如下面这个示例：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@late</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">tools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> os
    result <span class="token operator">=</span> this<span class="token punctuation">.</span>_tools

    <span class="token comment"># we don't want artists to see the admin tools</span>
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"_USER_ROLE"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"superuser"</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"delete-all"</span><span class="token punctuation">,</span> <span class="token string">"mod-things"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">_tools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> os
    <span class="token keyword">return</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">"./bin"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意在上述的代码中，_tools函数使用的一个相对路径，因为预绑定函数在进行构建求值时，该软件包是处于尚未安装的状态，所以诸如<code>this.root</code>之类的属性是不存在的。</p>
<p><strong>in_context 函数</strong></p>
<p>当后绑定函数求值时，将存在一个布尔函数in_context，如果软件包在解析后的环境中，返回True。<br>比如，仅使用rez API遍历软件包（如rez-search工具），则这些程序不属于解析后环境。</p>
<p>但如果创建一个ResolvedContext对象（如rez-env工具所做的）并遍历其已解析的软件包，则它们属于in_context。下面同样是一个示例：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@late</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">tools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"edit"</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> in_context<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token string">"maya"</span> <span class="token keyword">in</span> request<span class="token punctuation">:</span>
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"maya-edit"</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> result<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里检查request对象，查看是否当前环境请求了maya软件。如果是，将maya-edit工具加入列表。</p>
<p><strong>有效对象</strong></p>
<p>如果in_context返回True，下面是一些可用对象：</p>
<ul>
<li>context</li>
<li>system</li>
<li>building</li>
<li>request</li>
<li>implicits</li>
</ul>
<p>下面是无论in_context返回值，都可以使用的对象：</p>
<ul>
<li>this</li>
<li>in_context</li>
</ul>
<p><strong>示例 - 后绑定函数中的build_requires</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">name <span class="token operator">=</span> <span class="token string">"maya_thing"</span>

version <span class="token operator">=</span> <span class="token string">"1.0.0"</span>

variants <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"maya-2017"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"maya-2018"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>

<span class="token decorator annotation punctuation">@late</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">build_requires</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> this<span class="token punctuation">.</span>is_package<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">elif</span> this<span class="token punctuation">.</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"maya_2017_build_utils"</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">"maya_2018_build_utils"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里对this.is_package检查，实际上如果运行下面的命令，this的字段是一个包实例，并没有索引：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">]</span>$ rez<span class="token operator">-</span>search maya_thing <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">type</span> package <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">format</span> <span class="token string">'&#123;build_requires&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在这种情况下，this.is_package和this.index的返回值都为False，但是仍然可以用else返回一些值。</p>
<h1><span id="跨软件包共享">跨软件包共享</span></h1><p>跨包定义函数的属性是可以共享的，但是根据函数是预先绑定还是后绑定，机制上有些不同。</p>
<p>这是为了避免已经安装的软件包依赖于随时可能更改的外部代码。但是依赖于外部代码的构建是没有问题的。</p>
<h2><span id="在构建期间共享">在构建期间共享</span></h2><p>函数在package.py文件中构建的功能包括：</p>
<ul>
<li>预处理功能</li>
<li>任何使用<code>@early</code>装饰器实现为功能的包属性</li>
</ul>
<p>你可以使用<code>package_definition_build_python_paths</code>配置通用的共享属性。</p>
<h2><span id="在已经安装的程序之间共享">在已经安装的程序之间共享</span></h2><p>包括：</p>
<ul>
<li>各种<code>commands</code>函数属性</li>
<li>任何使用<code>@late</code>装饰器装饰的函数属性</li>
</ul>
<p>使用装饰器<code>@include</code>将函数进行共享，该装饰器依赖于<code>package_definition_python_path</code>的设置。</p>
<p>下面是一个共享模块包命令的例子：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># in package.py</span>
<span class="token decorator annotation punctuation">@include</span><span class="token punctuation">(</span><span class="token string">"utils"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    utils<span class="token punctuation">.</span>set_common_env_vars<span class="token punctuation">(</span>this<span class="token punctuation">,</span> env<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h1><span id="requires扩展">requires扩展</span></h1><p>通常软件包在构建时，可能比运行时需要更多的依赖项兼容。</p>
<p>例如，一个C++包可以针对任何版本的boost-1进行构建，但是有时需要链接到它针对的特定小版本，比如boost-1.55。你可以使用通配符号在requires属性（或任何相关属性比如build_requires）中这样去描述它：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">requires <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"boost-1.*"</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>你也可以将requires作为一个预绑定函数来实现刚刚的需求，结合rez包的expand_requires函数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">requires</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> rez<span class="token punctuation">.</span>package_py_utils <span class="token keyword">import</span> expand_requires
    <span class="token keyword">return</span> expand_requires<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"boost-1.*"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h1><span id="软件包预处理">软件包预处理</span></h1><p>你可以在全局或者在package.py文件中定义预处理功能。在构建软件包之前，<br>可以使用它来验证软件包，甚至修改某些属性。要设置这个功能，参考：<br><a target="_blank" rel="noopener" href="https://github.com/nerdvegas/rez/wiki/Configuring-Rez#package_preprocess_function">package_preprocess_function</a>配置设置。</p>
<p>看下面这个预处理示例：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">preprocess</span><span class="token punctuation">(</span>package<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> rez<span class="token punctuation">.</span>package_py_utils <span class="token keyword">import</span> InvalidPackageError
    <span class="token keyword">import</span> re

    <span class="token keyword">if</span> <span class="token keyword">not</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">"[a-z]+$"</span><span class="token punctuation">,</span> package<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> InvalidPackageError<span class="token punctuation">(</span><span class="token string">"Invalid name, only lowercase letters allowed"</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> package<span class="token punctuation">.</span>authors<span class="token punctuation">:</span>
        <span class="token keyword">from</span> preprocess_utils <span class="token keyword">import</span> get_git_committers
        data<span class="token punctuation">[</span><span class="token string">"authors"</span><span class="token punctuation">]</span> <span class="token operator">=</span> get_git_committers<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面的预处理程序会根据正则来检查软件包名称，并将包的authors属性设置为git_committers的返回值<br>（当包没有给予这个属性的时候）。如果软件包名称没有通过检查，需要停止构建，<br>必须在代码中引发一个”InvalidPackageError”的错误。</p>
<p><strong>Tips</strong>：要查看package.py的预处理内容，可以在其根目录运行命令：<br><code>rez-build --view-pre</code> 将会打印一个标准输出。</p>
<h2><span id="在预处理中覆盖配置设置">在预处理中覆盖配置设置</span></h2><p>比如在预处理中，覆盖软件包发布路径设置：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># in package.py</span>
<span class="token keyword">with</span> scope<span class="token punctuation">(</span><span class="token string">"config"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> c<span class="token punctuation">:</span>
    c<span class="token punctuation">.</span>release_packages_path <span class="token operator">=</span> <span class="token string">"/software/packages/external"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>假设一个场景，我们希望将第三方包安装到特定的路径，并且将这些包的属性”external”为True，我们可以在全局预处理函数中这样设置：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">preprocess</span><span class="token punctuation">(</span>package<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"external"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        _ <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"config"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"release_packages_path"</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span>  <span class="token comment"># already explicitly specified by package</span>
    <span class="token keyword">except</span> KeyError<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    data<span class="token punctuation">[</span><span class="token string">"config"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"config"</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    data<span class="token punctuation">[</span><span class="token string">"config"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"release_packages_path"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/software/packages/external"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1><span id="软件包范例">软件包范例</span></h1><p>下面是一个软件包定义文件，演示了几个特性。<br>这是个python软件包，该软件包不会实际安装python，而是检测现有系统的python安装，<br>并将其绑定到rez软件包中。（结合上述的知识来阅读它吧）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">name <span class="token operator">=</span> <span class="token string">"python"</span>

<span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> this<span class="token punctuation">.</span>__version <span class="token operator">+</span> <span class="token string">"-detected"</span>

authors <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"Guido van Rossum"</span>
<span class="token punctuation">]</span>

description <span class="token operator">=</span> \
    <span class="token triple-quoted-string string">"""
    The Python programming language.
    """</span>

<span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">variants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> rez<span class="token punctuation">.</span>package_py_utils <span class="token keyword">import</span> expand_requires
    requires <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"platform-**"</span><span class="token punctuation">,</span> <span class="token string">"arch-**"</span><span class="token punctuation">,</span> <span class="token string">"os-**"</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>expand_requires<span class="token punctuation">(</span><span class="token operator">*</span>requires<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">tools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    version_parts <span class="token operator">=</span> this<span class="token punctuation">.</span>__version<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token string">"2to3"</span><span class="token punctuation">,</span>
        <span class="token string">"pydoc"</span><span class="token punctuation">,</span>
        <span class="token string">"python"</span><span class="token punctuation">,</span>
        <span class="token string">"python%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>version_parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"python%s.%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>version_parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> version_parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>

uuid <span class="token operator">=</span> <span class="token string">"recipes.python"</span>

<span class="token keyword">def</span> <span class="token function">commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    env<span class="token punctuation">.</span>PATH<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"&#123;this._bin_path&#125;"</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> building<span class="token punctuation">:</span>
        env<span class="token punctuation">.</span>CMAKE_MODULE_PATH<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"&#123;root&#125;/cmake"</span><span class="token punctuation">)</span>

<span class="token comment"># --- internals</span>

<span class="token keyword">def</span> <span class="token function">_exec_python</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span> src<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> subprocess

    p <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>
        <span class="token punctuation">[</span><span class="token string">"python"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> src<span class="token punctuation">]</span><span class="token punctuation">,</span>
        stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>
    out<span class="token punctuation">,</span> err <span class="token operator">=</span> p<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> p<span class="token punctuation">.</span>returncode<span class="token punctuation">:</span>
        <span class="token keyword">from</span> rez<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> InvalidPackageError
        <span class="token keyword">raise</span> InvalidPackageError<span class="token punctuation">(</span>
            <span class="token string">"Error determining package attribute '%s':\n%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>attr<span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> out<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@early</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">_bin_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> this<span class="token punctuation">.</span>_exec_python<span class="token punctuation">(</span>
        <span class="token string">"_bin_path"</span><span class="token punctuation">,</span>
        <span class="token string">"import sys, os.path; print(os.path.dirname(sys.executable))"</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">_version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> _exec_python<span class="token punctuation">(</span>
        <span class="token string">"version"</span><span class="token punctuation">,</span>
        <span class="token string">"import sys; print(sys.version.split()[0])"</span><span class="token punctuation">)</span>

__version <span class="token operator">=</span> _version<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1><span id="软件包标准属性">软件包标准属性</span></h1><h2><span id="authorslist-of-string">authors（List of string）</span></h2><p><code>authors = [&quot;jchrist&quot;, &quot;sclaus&quot;]</code></p>
<p>软件包的作者，顺序从主要贡献者开始。</p>
<h2><span id="build_requireslist-of-string">build_requires（List of string）</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">build_requires <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"cmake-2.8"</span><span class="token punctuation">,</span>
    <span class="token string">"doxygen"</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>与require相同，只是这些依赖项只包含在构建期间（通常配合rez-build调用）</p>
<h2><span id="cachableboolean">cachable（Boolean）</span></h2><p><code>cachable = True</code></p>
<p>在启用包缓存时，是否可以缓存包。如果没有提供此参数，则由全局配置的”default_cachable”和相关的”default_cachable_*”设置中获取。</p>
<h2><span id="commandsfunction">commands（Function）</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    env<span class="token punctuation">.</span>PYTHONPATH<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"&#123;root&#125;/python"</span><span class="token punctuation">)</span>
    env<span class="token punctuation">.</span>PATH<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"&#123;root&#125;/bin"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>一个python代码块，告诉rez如何使用这个包更新环境。比如：</p>
<ul>
<li>设置，取消，前置或附加环境变量</li>
<li>创建别名</li>
<li>执行脚本</li>
<li>打印信息</li>
</ul>
<h2><span id="config">config</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> scope<span class="token punctuation">(</span><span class="token string">"config"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    release_packages_path <span class="token operator">=</span> <span class="token string">"/software/packages/apps"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>软件包可以使用它来覆盖rez配置设置。只在某些情况下有效，比如我们希望将包发布到一个与默认目录不同的路径。</p>
<h2><span id="descriptionstring">description（String）</span></h2><p><code>description = &quot;Library for communicating with the dead.&quot;</code><br>对软件包的总体描述。不要用它描述关于包的特定版本和细节，只应该提到包的一般特性。</p>
<h2><span id="has_pluginsboolean">has_plugins（Boolean）</span></h2><p><code>has_plugins = True</code><br>标识这个包是有插件的。</p>
<h2><span id="hashed_variantsboolean">hashed_variants（Boolean）</span></h2><p><code>hashed_variants = True</code><br>标识软件包根据variants内容的哈希值将variants安装到子目录中。</p>
<h2><span id="helpstring-or-list-of-string">help（String or List of string）</span></h2><p><code>help = &quot;https://github.com/nerdvegas/rez/wiki&quot;</code><br>软件包的帮助url页面，如果是包含空格的字符，则是要运行的命令。<br>如果是一个列表，代表帮助条目，可以使用SECTION参数指定要查看的条目。</p>
<h2><span id="namestringmandatory">name（String，mandatory）</span></h2><p><code>name = &quot;maya_utils&quot;</code><br>包的名称。允许使用字母数字和下划线，名称区分大小写。</p>
<h2><span id="plugin_forstring">plugin_for（String）</span></h2><p><code>plugin_for = &quot;maya&quot;</code><br>表明这个包是另一个包的插件。如上例子，这是一个maya插件。</p>
<h2><span id="post_commandsfunction">post_commands（Function）</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">post_commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    env<span class="token punctuation">.</span>FOO_PLUGIN_PATH<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"@"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>与pre_commands类似，但在最后运行，而不是在开始阶段。</p>
<h2><span id="pre_commandsfunction">pre_commands（Function）</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pre_commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> os<span class="token punctuation">.</span>path
    env<span class="token punctuation">.</span>FOO_PLUGIN_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>this<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token string">"plugins"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>和commands一样，执行顺序是pre_commands优先执行，然后是commands，最后是post_commands。</p>
<h2><span id="pre_test_commandsfunction">pre_test_commands（Function）</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pre_test_commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> test<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"unit"</span><span class="token punctuation">:</span>
        env<span class="token punctuation">.</span>IS_UNIT_TEST <span class="token operator">=</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>和commands类似，但它是在测试中的定义的每个测试之前运行。</p>
<h2><span id="relocatableboolean">relocatable（Boolean）</span></h2><p><code>relocatable = True</code><br>确定这个包是否可以复制到另一个包存储库。（例如使用rez-cp命令）<br>如果没有提供，则由全局配置”default_relocatable”和相关设置”default_relocatable_*”设置确定。</p>
<h2><span id="requireslist-of-string">requires（List of string）</span></h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">requires = <span class="token punctuation">[</span>
    <span class="token string">"python-2"</span><span class="token punctuation">,</span>
    <span class="token string">"maya-2016"</span><span class="token punctuation">,</span>
    <span class="token string">"maya_utils-3.4+&lt;4"</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这是包所依赖的其它包列表。</p>
<h2><span id="testsdict">tests（Dict）</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">tests <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"unit"</span><span class="token punctuation">:</span> <span class="token string">"python -m unittest discover -s &#123;root&#125;/python/tests"</span><span class="token punctuation">,</span>
    <span class="token string">"lint"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"command"</span><span class="token punctuation">:</span> <span class="token string">"pylint mymodule"</span><span class="token punctuation">,</span>
        <span class="token string">"requires"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"pylint"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">"run_on"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"default"</span><span class="token punctuation">,</span> <span class="token string">"pre_release"</span><span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token string">"maya_CI"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"command"</span><span class="token punctuation">:</span> <span class="token string">"python &#123;root&#125;/ci_tests/maya.py"</span><span class="token punctuation">,</span>
        <span class="token string">"on_variants"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"requires"</span><span class="token punctuation">,</span>
            <span class="token string">"value"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"maya"</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token string">"run_on"</span><span class="token punctuation">:</span> <span class="token string">"explicit"</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>定义的这个字典，代表可以使用rez-test工具在软件包运行测试。</p>
<p>例如在上述带有test属性的包maya_utils上运行linter：</p>
<pre class="line-numbers language-none"><code class="language-none">]$ rez-test maya_utils lint<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果测试条目是一个字符串或一个字符串列表，这将会解释为要运行的命令。<br>字符串扩展任何包属性引用，比如{root}。<br>如果提供了一个嵌套字典，你可以为每个测试指定额外的字段：</p>
<ul>
<li><strong>requires</strong>: 要包含在测试运行时env中额外包的依赖</li>
<li><strong>on_variants</strong>：哪些variants可以在测试里生效<ul>
<li><strong>True</strong>：所有variants</li>
<li><strong>False</strong>：只在一个variant上进行测试，即在env被解析时获得的variant（默认值）</li>
<li><strong>Dict</strong>：选择的variants，可以参考上面的”maya_CI”下”on_variants”的值</li>
</ul>
</li>
<li><strong>run_on</strong>: 什么时候运行这个测试。有效值:<ul>
<li><strong>default</strong>:  在不指定测试参数的情况下运行rez-test</li>
<li><strong>pre_install</strong>：在安装之前运行（即rez-build -i），并在安装失败后中止安装</li>
<li><strong>pre_release</strong>：在发布之前运行，失败则中止发布</li>
<li><strong>explicit</strong>：当rez-test运行时，仅在指定为TEST参数的时候执行</li>
</ul>
</li>
</ul>
<h2><span id="toolslist-of-string">tools（List of string）</span></h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">tools = <span class="token punctuation">[</span>
    <span class="token string">"houdini"</span><span class="token punctuation">,</span>
    <span class="token string">"hescape"</span><span class="token punctuation">,</span>
    <span class="token string">"hython"</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>软件包提供的工具列表。</p>
<h2><span id="uuidstring">uuid（String）</span></h2><pre class="line-numbers language-none"><code class="language-none">uuid &#x3D; &quot;489ad32867494baab7e5be3e462473c6&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>一个唯一值，可以用于标识相似名称的两个包。（一旦设置就不要更改它）<br>可以这样去获得一个uuid：</p>
<pre class="line-numbers language-none"><code class="language-none">]$ python -c &#39;import uuid; print(uuid.uuid4().hex)&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2><span id="variantslist-of-list-of-string">variants（List of list of string）</span></h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">variants = <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"maya-2015.3"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"maya-2016.1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"maya-2016.7"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>一个包可以包含的各种变体，可以看作是同一个包的不同版本变体，具有不同的依赖性。</p>
<h2><span id="versionstring">version（String）</span></h2><p><code>version = &quot;1.0.0&quot;</code><br>标识这个包的版本。</p>
<h1><span id="构建包时的属性">构建包时的属性</span></h1><p>这些属性只在包构建的时候生效，一旦安装完成，这些属性就走了。  </p>
<h2><span id="build_commandstring-or-false">build_command（String or False）</span></h2><p><code>build_command = &quot;bash &#123;root&#125;/build.sh &#123;install&#125;&quot;</code>  </p>
<p>包的构建命令。如果设置，它将在运行”rez-build”时执行这个构建命令。<br>如果为False，则不需要任何构建步骤（仍然会安装包）。<br>{root}字符同样是可用的字符扩展，代表构建路径根目录。<br>{install}字符为“install”如果安装正在进行，否则为空。<br>可以在build命令中引用的变量有：</p>
<ul>
<li>root</li>
<li>install</li>
<li>build_path：构建路径（也就是当前工作目录）</li>
<li>install_path：安装目标的完整路径</li>
<li>name：正在构建包的名称</li>
<li>variant_index：当前构建variant的索引</li>
<li>version：当前正在构建包的版本</li>
</ul>
<h2><span id="build_systemstring">build_system（String）</span></h2><p><code>build_system = &quot;cmake&quot;</code><br>指定构建这个包所使用的构建系统，如果未设置则在构建时自动检测。<br>或者也可以使用 —build-system option 来指定。  </p>
<h2><span id="pre_build_commandsfunction">pre_build_commands（Function）</span></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pre_build_commands</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    env<span class="token punctuation">.</span>FOO_BUILT_BY_REZ <span class="token operator">=</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>与commands类似，不同的是它在构建包之前运行。</p>
<h2><span id="preprocessfunction">preprocess（Function）</span></h2><p>见本文之前讲到的 “软件包预处理”  </p>
<h2><span id="private_build_requireslist-of-string">private_build_requires（List of string）</span></h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">private_build_requires = <span class="token punctuation">[</span>
    <span class="token string">"cmake-2.8"</span><span class="token punctuation">,</span>
    <span class="token string">"doxygen"</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>与build_requires相同，区别是这些依赖项只有在构建时才包括。</p>
<h2><span id="requires_rez_versionstring">requires_rez_version（String）</span></h2><p><code>requires_rez_version = &quot;2.10&quot;</code><br>定义了软件包所需的rez最小版本。</p>
<h1><span id="发布包时的属性">发布包时的属性</span></h1><p>当你的包通过rez-release工具发布时，Rez会创建以下包属性：</p>
<h2><span id="changelogstring">changelog（String）</span></h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">changelog = \
    <span class="token string">""</span>"
    commit 22abe31541ceebced8d4e209e3f6c44d8d0bea1c
    Author<span class="token operator">:</span> allan johns &lt;nerdvegas at gee mail dot com>
    Date<span class="token operator">:</span>   Sun May <span class="token number">15</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">39</span><span class="token operator">:</span><span class="token number">10</span> <span class="token number">2016</span> <span class="token number">-0700</span>

        first commit
    <span class="token string">""</span>"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>包含上次发布到现在的所有提交更改日志。这个更新日志的语法取决于版本管理工具，这里是基于git的一个例子。</p>
<h2><span id="previous_revisiontype-varies">previous_revision（Type varies）</span></h2><p>先前发布的软件包的修订信息。（如果有）</p>
<h2><span id="previous_versionstring">previous_version（String）</span></h2><p><code>previous_version = &quot;1.0.1&quot;</code><br>先前发布的包的版本(如果有的话)。</p>
<h2><span id="release_messagestring">release_message（String）</span></h2><p><code>release_message = &quot;Fixed the flickering thingo&quot;</code><br>程序包发布信息。可以通过发布工具<code>rez-release —message option</code>设置，<br>或者在发布时的文本编辑器中输入（后者需要rez配置设置TODO_ADD_THIS）。</p>
<h2><span id="revisiontype-varies">revision（Type varies）</span></h2><pre class="line-numbers language-json" data-language="json"><code class="language-json">revision = \
    <span class="token punctuation">&#123;</span>'branch'<span class="token operator">:</span> 'master'<span class="token punctuation">,</span>
     'commit'<span class="token operator">:</span> '22abe31541ceebced8d4e209e3f6c44d8d0bea1c'<span class="token punctuation">,</span>
     'fetch_url'<span class="token operator">:</span> 'git@github.com<span class="token operator">:</span>nerdvegas/dummy.git'<span class="token punctuation">,</span>
     'push_url'<span class="token operator">:</span> 'git@github.com<span class="token operator">:</span>nerdvegas/dummy.git'<span class="token punctuation">,</span>
     'tracking_branch'<span class="token operator">:</span> 'origin/master'<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>有关已发布包源代码修订信息。数据类型由所用的版本控制工具确定，这里是git-based的修订信息。</p>
<h2><span id="timestampinteger">timestamp（Integer）</span></h2><p><code>timestamp = 1463350552</code><br>包发布的时间。</p>
<h2><span id="vcsstring">vcs（String）</span></h2><p><code>vcs = &quot;git&quot;</code><br>发布包的版本控制工具的名字。</p>

</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/08%20rez-variants/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  08 Variants
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/06%20rez-package-commands/">
                06 Package Commands
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>




<script>
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">zhangly</a> 
	
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>